var MICROSTOCKS=function(){var e=function(e,o){return(void 0===e||isNaN(e)||null===e||"number"!=typeof e)&&(e=1,o=100),(void 0===o||isNaN(o)||null===o||"number"!=typeof o)&&(o=e,e=1),Math.floor(Math.random()*(o-e)+e)},o=function(){for(var o="",t=0;3>t;t++)o+=String.fromCharCode(65+e(26));return o},t=function(){var o=[{name:"Health",icon:"fa-heartbeat"},{name:"Natural",icon:"fa-paw"},{name:"Tech",icon:"fa-qrcode"},{name:"Rare",icon:"fa-diamond"},{name:"Mineral",icon:"fa-gg-circle"}];return o[e(0,o.length)]},s=function(o){var t="",s=[{name:"stable-up",maxFlux:e(0,3)},{name:"stable",maxFlux:e(-1,2)},{name:"stable-down",maxFlux:e(-2,0)}],n=[{name:"volatile-up",maxFlux:e(0,6)},{name:"volatile",maxFlux:e(-3,4)},{name:"volatile-down",maxFlux:e(-5,-1)}];return t="Health"==o.name||"Natural"==o.name?s[0]:"Mineral"==o.name?s[e(0,s.length)]:n[e(0,n.length)]},n=function(n){for(var a=[],r="",l=0;n>l;l++)a[l]={},r=t(),a[l].cost=e(e(2,5),e(20,e(20,110))),a[l].name=o(),a[l].type=r,a[l].trend=s(r);return a},a=function(o,t){for(var s=!1,n=0;t>n;n++)e(100)>70?(o[n].amount=e(e(1,4),e(5,20)),s=!0):o[n].amount=0;s===!1&&(o[e(0,o.length)].amount=e(e(1,4),e(5,20)))},r={},l=document.getElementsByClassName("log-list")[0],u=10,i=e(12,20),c=n(i);a(c,i),c.sort(function(e,o){return o.amount-e.amount});var d=["New York","Chicago","Philadelphia","Austin","Los Angeles","San Fransisco","Seattle","Portland","Minneapolis","Cleveland","Providence"],m={stats:{money:e(500),location:e(d.length),resources:c}},f=function(e,o,t){if(void 0!==o&&null!==o)for(var s="object"==typeof o?o.length:1,n="",a=0;s>a;a++){n="function"==typeof o[0]?o[0](o[1],o[2]):"object"==typeof o?o[a]:o;var r=document.createElement("LI"),l=document.createTextNode(n);r.appendChild(l),void 0!==e||null!==e?(e.appendChild(r),e.scrollTop=e.scrollHeight):console.error("addListElement exception: obj was null. Please call addListELement with a non-null, defined object as the first argument. See syntax: addListElement(obj, text, cssClass), with cssClass being optional.")}else console.error("addListElement exception: text was null. Please call addListELement with a non-null, defined text string as the second argument. See syntax: addListElement(obj, text, cssClass), with cssClass being optional.");if(void 0!==t&&null!==t){var u=t.split(" ");for(var i in u)u.hasOwnProperty(i)&&e.classList.add(u[i])}},p=function(e,o){var t=document.getElementsByClassName(e)[0];void 0!==t?t.innerText=o:console.error("changeListElement needs to be called with a valid cssClass and incoming text. Check your syntax: changeListElement(cssClass, text);")},h=function(){for(var o=m.stats.resources,t="",s="",n=0,a=250,r=0;r<o.length;r++)n=e(0,o[r].trend.maxFlux),t=o[r].name,s=o[r].trend.name,"stable-up"===s||"stable"===s||"stable-down"===s?e(100)<30&&(o[r].cost<a&&o[r].cost>1?(m.stats.resources[r].cost+=n,n>0?f(l,t+" has risen $"+n+" dollars.","resource-increase"):n>0&&f(l,t+" has fallen $"+Math.abs(n)+" dollars.","resource-decrease")):o[r].cost<1&&(m.stats.resources[r].cost=1,f(l,t+" bottomed out! Worth $1.","resource-decrease"))):e(100)<60&&(o[r].cost<a&&o[r].cost>1?(m.stats.resources[r].cost+=n,n>0?f(l,t+" has risen $"+n+" dollars.","resource-increase"):n>0&&f(l,t+" has fallen $"+Math.abs(n)+" dollars.","resource-decrease")):o[r].cost<1&&(m.stats.resources[r].cost=1,f(l,t+" bottomed out! Worth $1.","resource-decrease")))},g=function(){var e=m.stats;e.resources.sort(function(e,o){return o.amount-e.amount});for(var o="",t="",s=0;s<e.resources.length;s++)o=document.getElementsByClassName("resource-"+s)[0],t='<p><span class="fa '+e.resources[s].type.icon+' fa-fw"></span>'+e.resources[s].name+'</p><p><span class="fa fa-dollar fa-fw"></span>'+e.resources[s].cost+"</p>",e.resources[s].amount>0&&(t+='<p><span class="fa fa-shopping-cart fa-fw"></span>'+e.resources[s].amount+"</p>"),o.innerHTML=t,e.resources[s].amount>0&&!o.classList.contains("owned")?o.classList.add("owned"):0===e.resources[s].amount&&o.classList.contains("owned")&&o.classList.remove("owned")},y=function(){var e=m.stats;h(),p("cash","Money: $"+e.money);for(var o=0,t=0;t<e.resources.length;t++)o+=e.resources[t].amount*e.resources[t].cost;p("portfolio","Total Portfolio: $"+o);var s=document.getElementsByClassName("net-worth")[0],n=s.textContent;n=n.split("$"),parseInt(n[1])<o+parseInt(e.money)?p("net-worth","Net Worth: $"+(o+parseInt(e.money))+" --- Up!"):parseInt(n[1])===o+parseInt(e.money)?p("net-worth","Net Worth: $"+(o+parseInt(e.money))):p("net-worth","Net Worth: $"+(o+parseInt(e.money))+" --- Down!"),p("location","Location: "+d[e.location]),g()},v=function(){for(var e=[],o=0;o<m.stats.resources.length;o++)m.stats.resources[o].amount>0&&e.push(o);return 0!==e.length?!0:!1},b=function(){var o=[];if(m.stats.resources.length>1)for(var t=0;t<m.stats.resources.length;t++)m.stats.resources[t].amount>0&&o.push(t);m.stats.resourceIndex=0===o.length?0:o[e(0,o.length)]},x=function(o){var t=m.stats;"undefined"!=typeof o&&"object"!=typeof o?o<t.resources.length?m.stats.resourceIndex=o:console.error("updateResourceIndex exception: Incoming resourceIndex outside of bounds of resources array."):m.stats.resourceIndex=e(0,t.resources.length)},w=function(e){m.stats.location=e},C=function(e,o,t){var s="";void 0!==e&&null!==e?e.addEventListener("click",function(){"object"==typeof o&&void 0!==o&&null!==o?o.length>1?2===o.length?s=o[0](o[1]):3===o.length&&(s=o[0](o[1],o[2])):s=o():"function"==typeof o?s=o():(console.error("addButtonEvent called with undefined logMessage function. logMessage function should return a string. See syntax: addButtonEvent(button, logFunction, moreBehavior), with moreBehavior being an optional function."),console.error("typeof logMessage = "+typeof o)),void 0!==s&&f(l,s),void 0!==t&&null!==t&&("function"==typeof t?t():"object"==typeof t&&t[0](t[1]))}):console.error("addButtonEvent needs a defined, non-null button as it's first argument. See syntax: addButtonEvent(button, logFunction, moreBehavior), with moreBehavior being an optional function.")},E=function(e,o){"undefined"==typeof e||null===e?(x(),e=m.stats.resourceIndex):x(e);var t=void 0===o?1:o;return m.stats.money<m.stats.resources[e].cost*t?["Can't afford unit(s) of "+m.stats.resources[e].name+".","(Attempted to purchase "+t+".)"]:"You bought "+t+" unit(s) of "+m.stats.resources[e].name+"."},I=function(e){var o=m.stats,t=void 0===e?1:e,s=o.resourceIndex;o.money>=o.resources[s].cost*t?(m.stats.money=o.money-o.resources[s].cost*t,m.stats.resources[s].amount+=parseInt(t)):console.error("buyAction exception: Not enough money to make purchase."),y()},L=function(e,o){if("undefined"==typeof e||null===e){if(!v())return"You don't have any resource to sell! Try buying some.";b(),e=m.stats.resourceIndex}else x(e);var t=void 0===o?1:o;return m.stats.resources[e].amount>=t?"You sold "+t+" unit(s) of "+m.stats.resources[e].name+".":"You don't have "+t+" unit(s) of "+m.stats.resources[e].name+"."},N=function(e){if(v()){var o=m.stats,t=void 0===e?1:e,s=o.resourceIndex;o.resources[s].amount>=t&&(m.stats.resources[s].amount-=parseInt(t),m.stats.money=o.money+o.resources[s].cost*t,y())}},B=function(){var o=m.stats;if(o.money<u)return"Can't afford to move! Why don't you sell some resources?";x();for(var t=e(d.length);t===o.location;)t=e(d.length);return w(t),["Player moved to "+d[o.location],"Charged $"+u+" to go!"]},T=function(){var e=m.stats;e.money>=u&&(m.stats.money=parseInt(e.money)-u,y())},S=function(){$(".options-text").text("Microstocks"),$(".options-subtext").text("Version 1.0.5"),$(".options-author").html('Author: <a href="https://github.com/evangipson">Evan Gipson</a>'),$(".options").dialog({modal:!0,buttons:{Close:function(){$(this).dialog("close")}}})},M=function(e){var o=m.stats,t=0,s=0,n=0,a=1,r=o.resources[e].name,u=o.resources[e].type.name,i=o.resources[e].type.icon,c=o.resources[e].trend.maxFlux,d=o.resources[e].trend.name,p=o.resources[e].amount;$(".buy-sell-dialogue").html('<h3><span class="fa '+i+' fa-fw"></span>'+r+"</h3><hr /><ul><li>Type: "+u+"</li><li>Trend type: "+d+"</li><li>Avg. Trend amount: $"+c+"</li><li>You own "+p+" unit(s) of "+r+"</li></ul><hr />Would you like to buy or sell "+r+" today?"),$(".buy-sell").dialog({modal:!0,buttons:{Buy:function(){t=parseInt(o.money)/parseInt(o.resources[e].cost),1>t?$(".buy-sell-dialogue").html('<h3><span class="fa '+i+' fa-fw"></span>'+r+"</h3><hr /><ul><li>Type: "+u+"</li><li>Trend type: "+d+"</li><li>Avg. Trend amount: $"+c+"</li><li>You own "+p+" unit(s) of "+r+"</li></ul><hr />Can't afford any "+r+"! Try selling other stock!"):(s=t>=50?5:1,$(".buy-resource-slider").slider({value:1,min:1,max:t,step:s,slide:function(e,o){$(".buy-resource-amount").text("Buying "+o.value+" "+r+"!"),a=o.value}}),n=$(".resource-slider").slider("value"),$(".buy-resource-amount").text("Buying 1 "+r+"!"),$(".buy-dialog").dialog("open"))},Sell:function(){o.resources[e].amount>0?(s=o.resources[e].amount>=50?5:1,$(".sell-resource-slider").slider({value:1,min:1,max:o.resources[e].amount,step:s,slide:function(e,o){$(".sell-resource-amount").text("Selling "+o.value+" "+r+"."),a=o.value}}),n=$(".resource-slider").slider("value"),$(".sell-resource-amount").text("Selling 1 "+r+"."),$(".sell-dialog").dialog("open")):$(".buy-sell-dialogue").html('<h3><span class="fa '+i+' fa-fw"></span>'+r+"</h3><hr /><ul><li>Type: "+u+"</li><li>Trend type: "+d+"</li><li>Avg. Trend amount: $"+c+"</li><li>You own "+p+" unit(s) of "+r+"</li></ul><hr />You don't have any "+r+" to sell!")},Cancel:function(){$(this).dialog("close")}}}),$(".buy-dialog").dialog({autoOpen:!1,modal:!0,buttons:{Buy:function(){if(null!==a&&void 0!==a){var o=E(e,a);f(l,o),I(a)}else console.error("buySellDialogue exception: Resource purchase amount undefined or null, please try again!");$(".buy-sell").dialog("close"),$(this).dialog("close")},Cancel:function(){$(".buy-sell").dialog("close"),$(this).dialog("close")}}}),$(".sell-dialog").dialog({autoOpen:!1,modal:!0,buttons:{Sell:function(){if(null!==a&&void 0!==a){var o=L(e,a);f(l,o),N(a)}else console.error("buySellDialogue exception: Resource sell amount undefined or null, please try again!");$(".buy-sell").dialog("close"),$(this).dialog("close")},Cancel:function(){$(".buy-sell").dialog("close"),$(this).dialog("close")}}})},F=function(){for(var e=document.getElementsByClassName("resource"),o=0;o<e.length;o++)C(e[o],[M,o])},P=function(){for(var e=m.stats,o="",t="",s=[],n=document.getElementsByClassName("resource-list")[0],a="",r=0;r<e.resources.length;r++){a=document.createElement("LI"),t='<p><span class="fa '+e.resources[r].type.icon+' fa-fw"></span>'+e.resources[r].name+'</p><p><span class="fa fa-dollar fa-fw"></span>'+e.resources[r].cost+"</p>",e.resources[r].amount>0&&(t+='<p><span class="fa fa-shopping-cart fa-fw"></span>'+e.resources[r].amount+"</p>"),a.innerHTML=t,o="resource resource-"+r+" under-hover",e.resources[r].amount>0&&(o+=" owned"),s=o.split(" ");for(var l in s)s.hasOwnProperty(l)&&a.classList.add(s[l]);n.appendChild(a)}F()},j=function(){for(var e=m.stats,o=document.getElementsByClassName("inventory-list")[0],t=0,s=0;s<c.length;s++)t+=e.resources[s].amount*e.resources[s].cost;f(o,"Cash: $"+e.money,"money cash"),f(o,"Total Portfolio: $"+t,"money portfolio"),f(o,"Net Worth: $"+(t+parseInt(e.money)),"money net-worth"),f(o,"Location: "+d[e.location],"location"),P()};return r.init=function(){var e=document.getElementsByClassName("buy-button")[0],o=document.getElementsByClassName("sell-button")[0],t=document.getElementsByClassName("travel-button")[0],s=document.getElementsByClassName("options-button")[0];C(e,E,I),C(o,L,N),C(t,B,T),C(s,S),j()},r}();$(document).ready(function(){MICROSTOCKS.init()});